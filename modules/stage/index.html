<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<meta viewport="width=device-width">
<meta viewport="initial-scale=1">
<meta viewport="user-scalable=yes">
<title>The Stage Module</title>
<link href=https://dhemery.github.io/DHE-Modules/favicon.ico rel=icon>
<link rel=stylesheet href=https://dhemery.github.io/DHE-Modules/css/screen.css>
</head>
<body>
<header class="banner centered title">
<h1><a href=https://dhemery.github.io/DHE-Modules/>DHE Modules</a></h1>
<h2>VCV Rack modules from Dale Emery</h2>
</header>
<main>
<header class=boxed>
<h1 class=title><a href=https://dhemery.github.io/DHE-Modules/modules/stage/>The Stage Module</a></h1>
</header>
<section><img class=faceplate src=stage.svg alt="The Stage Faceplate">
<p>Generates a single envelope stage.</p>
<p>Combine
<a href=https://dhemery.github.io/DHE-Modules/modules/stage/><em>Stage</em></a>,
<a href=https://dhemery.github.io/DHE-Modules/modules/booster-stage/><em>Booster Stage</em></a>,
<a href=https://dhemery.github.io/DHE-Modules/modules/hostage/><em>Hostage</em></a>,
and <a href=https://dhemery.github.io/DHE-Modules/modules/upstage/><em>Upstage</em></a>
modules
to generate complex envelopes
with any number of stages.</p>
<p>See also:</p>
<ul>
<li><a href=https://dhemery.github.io/DHE-Modules/guides/generating-single-stage-envelopes/>Generating Single-Stage Envelopes</a></li>
<li><a href=https://dhemery.github.io/DHE-Modules/guides/generating-multi-stage-envelopes/>Generating Multi-Stage Envelopes</a></li>
<li><a href=https://dhemery.github.io/DHE-Modules/technical/how-stages-work-together>How Stages Work Together</a></li>
<li><a href=https://dhemery.github.io/DHE-Modules/technical/curves/>J and S Curves</a></li>
</ul>
<h2 id=controls>Controls</h2>
<ul>
<li>
<p><strong>LEVEL:</strong>
The voltage level at which each generated envelope stage ends.
The range is 0–10V.</p>
</li>
<li>
<p><strong>CURVE:</strong>
The
<a href=https://dhemery.github.io/DHE-Modules/technical/curves/>curvature</a>
of the envelope stage.</p>
</li>
<li>
<p><strong>DURATION:</strong>
The duration of the envelope stage.
The range is 10ms–10s,
with the center position
giving a duration of 1s.</p>
</li>
</ul>
<h2 id=ports>Ports</h2>
<ul>
<li>
<p><strong>DEFER:</strong>
When the <em>DEFER</em> gate signal is high,
<em>Stage</em> <strong><em>defers</em></strong> to its <em>IN</em> signal,
forwarding the <em>IN</em> signal
directly to the <em>OUT</em> output.</p>
<p>When it begins deferring,
<em>Stage</em> abandons any envelope stage
it may have been generating.</p>
</li>
<li>
<p><strong>TRIG:</strong>
When triggered,
<em>Stage</em> generates an envelope stage,
starting at the voltage sampled from the <em>IN</em> signal.</p>
<p>While <em>Stage</em> is deferring,
it ignores incoming triggers.</p>
</li>
<li>
<p><strong>IN:</strong>
When <em>Stage</em> generates an envelope stage,
the stage starts
at the voltage sampled from the <em>IN</em> signal.</p>
<p>While <em>Stage</em> is <em>deferring</em>,
it forwards the <em>IN</em> signal directly to its <em>OUT</em> output.</p>
</li>
<li>
<p><strong>ACTIVE:</strong>
A 10V gate signal indicating that <em>Stage</em>
is either actively generating an envelope stage
or deferring to its <em>IN</em> signal.</p>
</li>
<li>
<p><strong>EOC:</strong>
When <em>Stage</em> completes an envelope stage,
it emits a 1 millisecond 10V pulse
at its <em>EOC</em> output.</p>
</li>
<li>
<p><strong>OUT:</strong>
The generated envelope stage signal
or (when deferring) the <em>IN</em> signal.</p>
</li>
</ul>
<h2 id=notes>Notes</h2>
<ul>
<li>
<p>While an envelope stage is in progress,
all of the knobs are &ldquo;live.&rdquo;
If you adjust a knob,
<em>Stage</em> applies the new value
to the remainder of the stage.</p>
</li>
<li>
<p>Before <em>Stage</em> first becomes active
(by either a trigger or a <em>DEFER</em> gate),
it &ldquo;tracks&rdquo; its input
by sending its <em>IN</em> voltage to its <em>OUT</em> port.
Stage also enters this mode
when its <em>DEFER</em> gate falls (unless the <em>TRIG</em> port is high).</p>
</li>
<li>
<p>After <em>Stage</em> completes an envelope stage,
it &ldquo;tracks&rdquo; the <em>LEVEL</em> knob
by sending the <em>LEVEL</em> voltage to the <em>OUT</em> port.</p>
</li>
</ul>
<h2 id=state-model>State Model</h2>
<p><img src=stage-state-model.png alt="Stage State Model"></p>
<h3 id=trackinginput-mode>TrackingInput Mode</h3>
<p><em>Stage</em> starts in <em>TrackingInput</em> mode.
While <em>Stage</em> is <em>TrackingInput</em>:</p>
<ul>
<li>it is inactive</li>
<li>it &ldquo;tracks&rdquo; its input by sending its <em>IN</em> voltage to its <em>OUT</em> port</li>
<li>if <em>DEFER</em> rises, <em>Stage</em> enters <em>Deferring</em> mode</li>
<li>if <em>TRIG</em> rises, <em>Stage</em> enters <em>Generating</em> mode</li>
</ul>
<h3 id=deferring-mode>Deferring Mode</h3>
<p>Whatever mode <em>Stage</em> is in,
whenever its <em>DEFER</em> gate rises,
it enters <em>Deferring</em> mode.
While <em>Stage</em> is _Deferring:</p>
<ul>
<li>it is active</li>
<li>it sends its <em>IN</em> voltage to its <em>OUT</em> port</li>
<li>it ignores its <em>TRIG</em> port</li>
</ul>
<p>When the <em>DEFER</em> gate falls,
<em>Stage</em> resumes <em>TrackingInput</em>.</p>
<h3 id=generating-mode>Generating Mode</h3>
<p>If the <em>TRIG</em> port rises
while <em>Stage</em> is not <em>Deferring</em>,
it begins <em>Generating</em> a stage.
While <em>Stage</em> is <em>Generating</em>:</p>
<ul>
<li>it is active</li>
<li>it advances its phase and generates the appropriate voltage at its <em>OUT</em> port</li>
<li>if the stage completes,
<em>Stage</em> initiates a short pulse on its <em>EOC</em> port
and enters <em>TrackingLevel</em> mode</li>
<li>if <em>DEFER</em> rises, <em>Stage</em> enters <em>Deferring</em> mode</li>
<li>if <em>TRIG</em> rises, <em>Stage</em> abandons the stage it is generating and begins a new one</li>
</ul>
<h3 id=trackinglevel-mode>TrackingLevel Mode</h3>
<p>While <em>Stage</em> is <em>TrackingLevel</em>:</p>
<ul>
<li>it is inactive</li>
<li>it sends the voltage of its <em>LEVEL</em> knob to its <em>OUT</em> port</li>
<li>if <em>DEFER</em> rises, <em>Stage</em> enters <em>Deferring</em> mode</li>
<li>if <em>TRIG</em> rises, <em>Stage</em> enters <em>Generating</em> mode</li>
</ul>
</section>
</main>
<footer class="centered chrome">
<p role=copyright>© 2017–2022 Dale H. Emery</p>
</footer>
</body>
</html>